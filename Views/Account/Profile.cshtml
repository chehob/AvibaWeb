@model AvibaWeb.Models.AccountViewModels.ProfileViewModel
@{
    ViewData["Title"] = "Profile";
}

<div class="ch-container">
    <div class="row">


        </li>
        <li class="nav-header hidden-md">Раздел</li>
        <li>

        </li>

        </ul>
    </div>
</div>
</div>
<!--/span-->
<!-- left menu ends -->
</div>
<div class="box col-md-10">
    <form asp-controller="Account" asp-action="UpdateProfile" enctype="multipart/form-data"
          data-ajax-update="#results" data-ajax="true" data-ajax-method="post">
        <div id="photoDiv"></div>
        <input asp-for="Photo" id="photoFile" type="file" name="Photo" style="display: none;" accept=".jpg,.jpeg,.png" />
        <span id="fileError"></span>
        <input asp-for="PhoneNumber" type="text" />
        <input type="submit" class="btn btn-default" value="Сохранить" />
    </form>
    <a href="https://pushall.ru/?fs=4538&key=6ffbd668aba3088393123f23df2597a4">Подписаться на PushAll</a>
    <div id="results"></div>

    <script type="text/javascript">
        $('#photoDiv').on('click', function () {
            $('#photoFile').click();
        });

        $("#photoFile").change(function () {
            const inputElement = $("#photoFile");
            const errorElement = $("#fileError");
            errorElement.html("");
            const file = this.files[0];
            const fileSize = file.size;
            if (fileSize > 300 * 1024) {
                errorElement.html("Размер файла не может превышать 300KB");
                inputElement.wrap('<form>').parent('form').trigger('reset');
                inputElement.unwrap();
                return;
            }
            const reader = new FileReader();
            reader.onloadend = function () {
                $("#photoDiv").css("background-image", `url(${this.result})`);
            }
            if (file) {
                reader.readAsDataURL(file);
            }
        });
    </script>
    <style>
        #photoDiv {
            background-image: url('@Url.Action("UserPhoto", "Account")');
            background-size: cover;
            background-position: center;
            height: 200px;
            width: 200px;
            border: 1px solid #000;
        }
    </style>
